  - name: show iteration 
    debug:
      var: mycred
  - name: Initialize a new dict for the cleared credentials 
    set_fact:
      target_credential: {}
  - name: Extract credential dict from the full list 
    set_fact: 
      raw_credential: "{{all_credentials.json.results  | selectattr('id' , 'equalto', mycred) | first}}"
    
  # - name: display raw credential
  #   debug:
  #     var: raw_credential
  - name: Create a temporary dictionary for target credential 
    set_fact:
      target_credential:
        name: "{{raw_credential.name}}_1"
        organization: "{{raw_credential.organization | default('Default')}}"
        description: "{{raw_credential.description | default('Imported automatically')}}"
        credential_type: "{{raw_credential.summary_fields.credential_type.name}}"
        inputs: "{{raw_credential.inputs | default({}) | combine(unencrypted_inputs)}}"
        user: "admin"
    vars:
      unencrypted_inputs: "{{ dict(credentials_unprotected[mycred]) }}"
  - name: Show the credential to be created 
    debug:
      var: target_credential
  - name: Add the cred to the list 
    set_fact: 
      controller_credentials: "{{controller_credentials + [target_credential]}}"
  - name: show target credential 
    debug: 
      var: controller_credentials
  - name: run creation on target
    include_role:
      name: infra.controller_configuration.credentials
    vars: 
      controller_hostname: "{{target_aap_host}}"
      controller_username: "{{target_aap_user}}"
      controller_password: "{{target_aap_pass}}"
    